import{j as e,r as a,C as m,L as h,O as f,a as u,u as g,b,c as N,d as w,R as v}from"./index-Cf9y9cQ9.js";function S({title:s,subTitle:l}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"grow",children:[e.jsx("h1",{className:"text-5xl pb-5",children:s}),e.jsx("h2",{className:"text-base md:text-3xl pb-3",children:l})]})})})}function y({url:s,sizeClass:l}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"avatar mb-5 w-full place-content-center",children:e.jsx("div",{className:`${l} rounded shadow-lg `,children:e.jsx("img",{src:s})})})})}function k({title:s,nameValList:l}){const n=l.map(o=>e.jsxs("li",{className:"mb-1",children:[e.jsx("a",{href:`${o.url}`,className:"link link-accent",target:"_blank",children:o.name})," - ",o.desc]}));return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"shadow-lg bg-teal-100 text-left	p-3 mb-5",children:[e.jsx("p",{className:"text-center mb-2",children:s}),e.jsx("ul",{children:n})]})})}function T({title:s,text:l}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"shadow-lg bg-teal-100 text-left	p-3 mb-5",children:[e.jsx("p",{className:"text-center mb-2",children:s}),e.jsx("p",{className:"whitespace-pre-wrap",children:l})]})})}function E(){const[s,l]=a.useState("");return a.useEffect(()=>{fetch("/components").then(n=>n.json()).then(n=>{if(n.result=="success"){const i=n.components.map(c=>{switch(c.type){case m.VIEW_COMPONENT_TYPE_PROFILE_PIC:{const t=JSON.parse(c.json);return e.jsx(y,{url:t.url,sizeClass:`pp-w-${t.size}`})}case m.VIEW_COMPONENT_TYPE_LINK_LIST:{const t=JSON.parse(c.json);return e.jsx(k,{title:t.title,nameValList:t.items})}case m.VIEW_COMPONENT_TYPE_TEXT_BOX:{const t=JSON.parse(c.json);return e.jsx(T,{title:t.title,text:t.text})}default:{console.log("View Component Type not supported: "+c.type);break}}});l(i)}else alert(JSON.stringify(n.messages))}).catch(n=>{console.log(n.message),alert("Failed to load componetns.")})},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"py-4",children:s}),e.jsx("div",{className:"py-4 text-center text-slate-400",children:e.jsx("a",{href:"/m/",children:e.jsx("button",{className:"btn btn-ghost btn-sm m-2",children:"Manage"})})})]})}function P(){const[s,l]=a.useState(""),[n,o]=a.useState(""),[i,c]=a.useState(!1),[t,d]=a.useState(!1),[x,p]=a.useState("");a.useEffect(()=>{fetch("/basic-info").then(r=>r.json()).then(r=>{r.result=="success"?(l(r.title),document.title=r.title,o(r.subTitle),c(!0),p(r.iconUrl),r.faviconUrl!=""&&D(r.faviconUrl)):alert(JSON.stringify(r.messages)),console.log(r)}).catch(r=>{console.log(r.message),alert("Failed to load articles.")})},[]);const j=r=>{r.preventDefault(),d(!t)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto font-mono",children:[e.jsx(h,{loaded:i}),e.jsxs("div",{className:i?"visible":"invisible",children:[e.jsxs("div",{className:"columns-1 text-left",children:[e.jsx(S,{title:s,subTitle:n}),e.jsxs("div",{className:"flex md:hidden",children:[e.jsx(C,{iconUrl:x}),e.jsx("a",{className:"link link-accent mt-2",onClick:j,children:t?"Back to Posts":"Show About Me"})]})]}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:t?" hidden ":" col-span-4 md:col-span-3",children:e.jsx(f,{context:[i,c]})}),e.jsx("div",{className:t?" col-span-4 ":" hidden   md:col-span-1 md:block md:pl-4",children:e.jsx(E,{})})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-slate-400 text-center",children:["Powered by ",e.jsx("a",{className:"link",target:"_blank",href:"https://github.com/marusasa/serverless-blog",children:"Serverless Blog Project"})]})})]})]})})}function C({iconUrl:s}){return s!=""?e.jsx("img",{src:s,className:"w-10 rounded-full mr-4 shadow-lg"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-10 mr-4 shadow-lg rounded-full",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})})}function D(s){const l=document.createElement("link");l.rel="shortcut icon",l.type="image/png",l.href=s,document.head.appendChild(l)}function L({article:s}){const l=s.publishedAt.substring(0,10),o=new Date(s.publishedAt).toLocaleDateString(),i=M(s.title)+"_"+s.articleId,c=a.useRef(null),t=d=>{d.preventDefault(),c.current.showModal()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card bg-white w-full mb-8 text-left shadow-lg border-solid border border-slate-200 p-4 md:p-8",children:e.jsx("div",{className:"card-body p-0",children:e.jsxs("article",{children:[e.jsx("h2",{className:"card-title",children:s.title}),e.jsx("p",{className:"font-thin italic",children:e.jsx("time",{dateTime:l,children:o})}),e.jsx("p",{className:"whitespace-pre-wrap line-clamp-4 mb-3",children:s.body}),e.jsxs("p",{children:[e.jsx(u,{to:"/post/"+i,className:"link link-accent mr-5",children:"Read More..."}),e.jsx("a",{className:s.summary==""||s.summary==null?"invisible":"visible link link-accent",onClick:t,children:"Show AI Summary"})]})]})})}),e.jsx("dialog",{id:"my_modal_1",className:"modal",ref:c,children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"AI Summary:"}),e.jsx("p",{className:"py-4",children:s.summary}),e.jsx("div",{className:"modal-action",children:e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn",children:"OK"})})})]})})]})}function M(s){s=s.replaceAll(" ","-");const l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-",n=new RegExp(`[^${l}]`,"g");return s.replace(n,"")}function I(){const[s,l]=a.useState([]),[n,o]=g(),[i,c]=a.useState(!1);return a.useEffect(()=>{c(!1),fetch("/articles").then(t=>t.json()).then(t=>{t.result=="success"?(c(!0),l(t.articles)):alert(JSON.stringify(t.messages)),console.log(t)}).catch(t=>{console.log(t.message),alert("Failed to load articles.")})},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"py-4",children:[e.jsx(h,{loaded:n?i:!0}),s.map(t=>e.jsx(L,{article:t},t.articleId))]})})}function O(){const s=b(),[l,n]=a.useState({}),[o,i]=a.useState(""),[c,t]=a.useState("");return a.useEffect(()=>{try{if(s.result=="success"){n(s.article),i(s.article.publishedAt.substring(0,10));const d=new Date(s.article.publishedAt);t(d.toLocaleDateString())}else alert("Post not loaded.")}catch(d){console.log(d),alert("Error loading data.")}}),e.jsx(e.Fragment,{children:e.jsx("div",{className:"py-4",children:e.jsx("div",{className:"card bg-white w-full mb-8 text-left shadow-lg border-solid border border-slate-200 p-4 md:p-8",children:e.jsx("div",{className:"card-body p-0",children:e.jsxs("article",{children:[e.jsx("p",{children:e.jsx(u,{to:"/",className:"link link-accent",children:"Blog Top"})}),e.jsx("h2",{className:"card-title",children:l.title}),e.jsx("p",{className:"font-thin italic",children:e.jsx("time",{dateTime:o,children:c})}),e.jsx("p",{className:"whitespace-pre-wrap",children:l.body})]})})})})})}async function A({params:s}){const l=s.postId;return fetch("/articles/"+l)}const _=N([{path:"/",element:e.jsx(P,{}),children:[{index:!0,element:e.jsx(I,{})},{path:"post/:postId",element:e.jsx(O,{}),loader:A}]}]);w(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(v,{router:_})}));
