import{j as e,L as N,r as a,a as w,C as v,O as V,u as R,b as E,M as Y,c as B,d as J,e as W,R as H}from"./index-BTWJDle-.js";function z({title:s,subTitle:t}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"grow",children:[e.jsx("h1",{className:"text-5xl pb-5",children:e.jsx("a",{href:"/",children:s})}),e.jsx("h2",{className:"text-base md:text-3xl pb-3",children:t})]})})})}function $({url:s,sizeClass:t}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"avatar mb-5 w-full place-content-center",children:e.jsx("div",{className:`${t} rounded shadow-lg `,children:e.jsx("img",{src:s})})})})}function K({title:s,nameValList:t}){const n=t.map(o=>e.jsxs("li",{className:"mb-1",children:[e.jsx("a",{href:`${o.url}`,className:"link link-accent",target:"_blank",children:o.name})," - ",o.desc]}));return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"shadow-lg bg-teal-100 text-left	p-3 mb-5",children:[e.jsx("p",{className:"text-center mb-2",children:s}),e.jsx("ul",{children:n})]})})}function Z({title:s,text:t}){const n=o=>{const c=/\[([^\]]+)\]\(([^)]+)\)/g,d=o.split(c);let i=!1;return d.map((x,p)=>{if(p%3===1&&p+1<d.length){const j=x,m=d[p+1];return i=!0,e.jsx("a",{href:m,target:"_blank",className:"link link-accent",children:j},p)}return i?(i=!1,""):x})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"shadow-lg bg-teal-100 text-left	p-3 mb-5",children:[e.jsx("p",{className:"text-center mb-2",children:s}),e.jsx("p",{className:"whitespace-pre-wrap",children:n(t)})]})})}function L(s){s=s.replaceAll(" ","-");const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-",n=new RegExp(`[^${t}]`,"g");return s.replace(n,"")}function M({tagName:s,tagId:t,index:n}){const o=t+"/"+L(s);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"badge badge-lg mr-3 shadow-md bg-stone-50",children:e.jsx(N,{to:"/tag/"+o,reloadDocument:!0,children:s})})})})}function G(){const[s,t]=a.useState(""),[n,o]=a.useState(!1);return a.useEffect(()=>{fetch("/tags").then(c=>c.json()).then(c=>{if(c.result=="success"){const d=c.tags.map((i,x)=>e.jsx(M,{tagName:i.name,tagId:i.tagId,index:x}));t(d),o(!0)}else alert("Post not loaded...")}).catch(c=>{console.log(c.message),alert("Failed to load data.")})},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"shadow-lg bg-teal-100 text-left	p-3 mb-5",children:[e.jsx("p",{className:"text-center mb-2",children:"Tags"}),e.jsx(w,{loaded:n}),e.jsx("div",{className:"flex flex-wrap "+(n?"visible":"invisible"),children:s})]})})}function X(){const[s,t]=a.useState("");return a.useEffect(()=>{fetch("/components").then(n=>n.json()).then(n=>{if(n.result=="success"){const c=n.components.map(d=>{switch(d.type){case v.VIEW_COMPONENT_TYPE_PROFILE_PIC:{const i=JSON.parse(d.json);return e.jsx($,{url:i.url,sizeClass:`pp-w-${i.size}`})}case v.VIEW_COMPONENT_TYPE_LINK_LIST:{const i=JSON.parse(d.json);return e.jsx(K,{title:i.title,nameValList:i.items})}case v.VIEW_COMPONENT_TYPE_TEXT_BOX:{const i=JSON.parse(d.json);return e.jsx(Z,{title:i.title,text:i.text})}case v.VIEW_COMPONENT_TYPE_TAGS:return e.jsx(G,{});default:{console.log("View Component Type not supported: "+d.type);break}}});t(c)}else alert(JSON.stringify(n.messages))}).catch(n=>{console.log(n.message),alert("Failed to load componetns.")})},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"py-4",children:[s,e.jsx("div",{className:"flex justify-center",children:e.jsx("a",{href:"/feed",className:"link link-accent text-lg ",children:e.jsxs("button",{className:"btn btn-ghost",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 19.5v-.75a7.5 7.5 0 0 0-7.5-7.5H4.5m0-6.75h.75c7.87 0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})}),"Feed"]})})})]}),e.jsx("div",{className:"text-center text-slate-400",children:e.jsx("a",{href:"/m/",children:e.jsx("button",{className:"btn btn-ghost btn-sm m-2",children:"Manage"})})})]})}const l=class l{static init(t){this.visitorId=t,setInterval(function(){l.currentPath!=window.location.pathname?(l.currentPath!==""&&l.sendEvent(t,l.currentPath,"hidden"),l.currentPath=window.location.pathname,l.sendEvent(t,window.location.pathname,document.visibilityState),l.hiddenVisibleSent=!1,l.timeOnPage=0):l.hiddenVisibleSent===!1&&l.lastSentStatus=="visible"&&document.visibilityState==="visible"&&(l.timeOnPage=l.timeOnPage+l.INTERVAL,l.timeOnPage>=1e4&&(l.sendEvent(t,l.currentPath,"hidden&visible"),l.hiddenVisibleSent=!0))},l.INTERVAL),document.onvisibilitychange=()=>{l.sendEvent(t,l.currentPath,document.visibilityState)}}static sendEvent(t,n,o){console.log(new Date+" "+t+" "+n+" "+o),fetch("/analytics",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitorId:t,path:n,state:o}),keepalive:!0}).catch(c=>{console.error(c)}),l.lastSentStatus=o}};l.currentPath="",l.visitorId=0,l.timeOnPage=0,l.INTERVAL=1e3,l.hiddenVisibleSent=!1,l.lastSentStatus="";let C=l;function Q(){const[s,t]=a.useState(""),[n,o]=a.useState(""),[c,d]=a.useState(!1),[i,x]=a.useState(!1),[p,j]=a.useState(""),[m,f]=a.useState(0);a.useEffect(()=>{fetch("/basic-info").then(h=>h.json()).then(h=>{h.result=="success"?(t(h.title),document.title=h.title,o(h.subTitle),d(!0),j(h.iconUrl),h.faviconUrl!=""&&U(h.faviconUrl),f(h.visitorId),C.init(h.visitorId)):alert(JSON.stringify(h.messages)),console.log(h)}).catch(h=>{console.log(h.message),alert("Failed to load articles.")})},[]);const b=h=>{h.preventDefault(),x(!i)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto font-mono",children:[e.jsx(w,{loaded:c}),e.jsxs("div",{className:c?"visible":"invisible",children:[e.jsxs("div",{className:"columns-1 text-left",children:[e.jsx(z,{title:s,subTitle:n}),e.jsxs("div",{className:"flex md:hidden",children:[e.jsx(q,{iconUrl:p}),e.jsx("a",{className:"link link-accent mt-2",onClick:b,children:i?"Back to Posts":"Show About Me + More"})]})]}),e.jsxs("div",{className:"grid grid-cols-6",children:[e.jsx("div",{className:i?" hidden ":" col-span-6 md:col-span-4",children:e.jsx(V,{context:[c,d]})}),e.jsx("div",{className:i?" col-span-6 ":" hidden   md:col-span-2 md:block md:pl-4",children:e.jsx(X,{})})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-slate-400 text-center",children:["Powered by ",e.jsx("a",{className:"link",target:"_blank",href:"https://github.com/marusasa/serverless-blog",children:"Serverless Blog Project"})]})})]})]})})}function q({iconUrl:s}){return s!=""?e.jsx("img",{src:s,className:"w-10 rounded-full mr-4 shadow-lg"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-10 mr-4 shadow-lg rounded-full",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})})}function U(s){const t=document.createElement("link");t.rel="shortcut icon",t.type="image/png",t.href=s,document.head.appendChild(t)}function _({article:s}){const t=s.publishedAt.substring(0,10),o=new Date(s.publishedAt).toLocaleDateString(),c=a.useRef(null),d=x=>{x.preventDefault(),c.current.showModal()},i=L(s.title)+"_"+s.articleId;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card bg-white w-full mb-8 text-left shadow-lg border-solid border border-slate-200 p-4 md:p-8",children:e.jsxs("div",{className:"card-body p-0",children:[e.jsx("h2",{className:"card-title",children:s.title}),e.jsx("p",{className:"font-thin italic",children:e.jsx("time",{dateTime:t,children:o})}),e.jsx("p",{className:"whitespace-pre-wrap line-clamp-4 mb-3",children:s.body}),e.jsxs("p",{children:[e.jsx(N,{to:"/post/"+i,className:"link link-accent mr-5",children:"Read More..."}),e.jsx("a",{className:s.summary==""||s.summary==null?"invisible":"visible link link-accent",onClick:d,children:"Show AI Summary"})]})]})}),e.jsx("dialog",{id:"my_modal_1",className:"modal",ref:c,children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"AI Summary:"}),e.jsx("p",{className:"py-4",children:s.summary}),e.jsx("div",{className:"modal-action",children:e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn",children:"OK"})})})]})})]})}function ee(){const[s,t]=a.useState([]),[n,o]=R(),[c,d]=a.useState(!1),[i,x]=a.useState(!0),[p,j]=a.useState([0]),[m,f]=a.useState(1),[b,h]=a.useState(0),k=()=>{d(!1),fetch("/articles/page/"+p[m-1]).then(g=>g.json()).then(g=>{g.result=="success"?(d(!0),t(g.articles),x(g.hasMore),p.length==m&&(p.push(g.lastQueryVal),j(p)),m==1&&h(g.pageTotal),window.scrollTo({top:0,behavior:"smooth"})):alert(JSON.stringify(g.messages)),console.log(g)}).catch(g=>{console.log(g.message),alert("Failed to load articles.")})};a.useEffect(()=>{k()},[m]);const S=()=>{f(m+1)},P=()=>{f(m-1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"py-4",children:[e.jsx(w,{loaded:n?c:!0}),s.map(g=>e.jsx(_,{article:g},g.articleId))]}),e.jsx("div",{className:"flex flex-col items-center pb-4 "+(c?"":"hidden"),children:e.jsxs("div",{children:[e.jsx("button",{className:"btn btn-secondary btn-sm mr-3 px-6 "+(m==1?" btn-disabled ":""),onClick:P,children:"<"}),e.jsxs("span",{children:["Page: ",m,"/",b]}),e.jsx("button",{className:"btn btn-secondary btn-sm ml-3 px-6 "+(i?" ":" btn-disabled "),onClick:S,children:">"})]})})]})}function se(){const s=E(),[t,n]=a.useState({}),[o,c]=a.useState(""),[d,i]=a.useState(""),x=a.useRef(null),[p,j]=a.useState(!1),[m,f]=a.useState(0),[b,h]=a.useState(!1),[k,S]=a.useState(!1),[P,g]=a.useState("");a.useEffect(()=>{const u=s.postId;fetch("/articles/"+u).then(r=>r.json()).then(r=>{if(r.result=="success"){n(r.article),f(r.article.likes),c(r.article.publishedAt.substring(0,10));const F=new Date(r.article.publishedAt);i(F.toLocaleDateString());const y=r.article.tagIds.map((le,I)=>e.jsx(M,{tagName:r.article.tagNames[I],tagId:r.article.tagIds[I],index:I}));y.length>0&&y.unshift(e.jsx("div",{className:"mr-1",children:"Tags:"})),g(y),j(!0)}else alert("Post not loaded...")}).catch(r=>{console.log(r.message),alert("Failed to load article.")}).finally(()=>{x.current.addEventListener("click",D)})},[]);const D=u=>{u.target.tagName==="A"&&u.target.getAttribute("href").toLowerCase().startsWith("http")&&(u.preventDefault(),window.open(u.target.href,"_blank"))},O=u=>{u.preventDefault(),h(!0),fetch("/articles/"+t.articleId+"/like",{method:"PATCH",headers:{"Content-type":"application/json; charset=UTF-8"}}).then(r=>r.json()).then(r=>{r.result=="success"?(S(!0),f(r.count)):alert(JSON.stringify(r.messages))}).catch(r=>{alert("Failed to like."),console.log(r.message)}).finally(()=>{h(!1)})},T=u=>{let r=u.replace(/^\s+|\s+$/g,"");return r=r.toLowerCase(),r=r.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),r},A={h1:({children:u})=>e.jsx("h1",{id:T(u),children:u}),h2:({children:u})=>e.jsx("h2",{id:T(u),children:u}),h3:({children:u})=>e.jsx("h3",{id:T(u),children:u})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"py-4",children:e.jsx("div",{className:"card bg-white w-full mb-8 text-left shadow-lg border-solid border border-slate-200 p-4 md:p-8",children:e.jsxs("div",{className:"card-body p-0",children:[e.jsx(w,{loaded:p}),e.jsxs("article",{className:p?"visible":"invisible",children:[e.jsx("p",{children:e.jsx(N,{to:"/",className:"link link-accent",children:"Blog Top"})}),e.jsx("h2",{className:"card-title",children:t.title}),e.jsx("p",{className:"font-thin italic",children:e.jsx("time",{dateTime:o,children:d})}),e.jsxs("div",{className:"mb-3 flex",children:[e.jsx("div",{className:"mr-1",children:"Likes:"}),e.jsxs("button",{className:"btn btn-xs btn-ghost mr-3",onClick:O,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:k?"oklch(var(--er))":"white",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),e.jsx("span",{className:"text-base "+(b?"hidden":""),children:m}),e.jsx("span",{className:(b?"":"hidden ")+" loading loading-spinner"})]}),P]}),e.jsx("p",{className:"prose max-w-none",ref:x,children:e.jsx(Y,{className:"reactMarkDown",remarkPlugins:[B],components:A,children:t.body})})]})]})})})})}function te({article:s}){const t=L(s.title)+"_"+s.articleId,n=a.useRef(null),o=c=>{c.preventDefault(),n.current.showModal()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card bg-white w-full mb-8 text-left shadow-lg border-solid border border-slate-200 p-4 md:p-8",children:e.jsx("div",{className:"card-body p-0",children:e.jsxs("div",{className:"flex flex-wrap",children:[e.jsx("h2",{className:"card-title",children:e.jsx(N,{to:"/post/"+t,className:"tag-link mr-5",children:s.title})}),e.jsx("p",{className:"mt-0.5",children:e.jsx("a",{className:s.summary==""||s.summary==null?"invisible":"visible link link-accent",onClick:o,children:"Show AI Summary"})})]})})}),e.jsx("dialog",{id:"my_modal_1",className:"modal",ref:n,children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"AI Summary:"}),e.jsx("p",{className:"py-4",children:s.summary}),e.jsx("div",{className:"modal-action",children:e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn",children:"OK"})})})]})})]})}function ae(){const s=E(),[t,n]=a.useState([]),[o,c]=a.useState(""),[d,i]=a.useState(""),[x,p]=a.useState(!1);return a.useEffect(()=>{const j=s.tagId;fetch("/articles/tag/"+j).then(m=>m.json()).then(m=>{m.result=="success"?(n(m.articles),c(m.tagName),i(m.tagDescription),p(!0)):alert("Post not loaded...")}).catch(m=>{console.log(m.message),alert("Failed to load articles.")}).finally(()=>{})},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"py-4",children:[e.jsx(w,{loaded:x}),e.jsxs("div",{className:x?"visible":"invisible",children:[e.jsx("p",{className:"whitespace-pre-wrap mb-3",children:e.jsx(N,{to:"/",className:"link link-accent",children:"Blog Top"})}),e.jsxs("p",{className:"whitespace-pre-wrap mb-3",children:["Posts with tag: ",e.jsx("span",{className:"badge badge-lg mr-3 shadow-md bg-stone-50",children:o})]}),e.jsx("p",{className:"whitespace-pre-wrap mb-5",children:d}),t.map(j=>e.jsx(te,{article:j},j.articleId))]})]})})}location.hostname!="localhost"&&location.protocol!=="https:"&&location.replace(`https:${location.href.substring(location.protocol.length)}`);const ne=J([{path:"/",element:e.jsx(Q,{}),children:[{index:!0,element:e.jsx(ee,{})},{path:"post/:postId",element:e.jsx(se,{})},{path:"tag/:tagId/*",element:e.jsx(ae,{})}]}]);W(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(H,{router:ne})}));
